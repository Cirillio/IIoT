# DipMod - –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞

## –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

 **–¢–∏–ø –ø—Ä–æ–µ–∫—Ç–∞** : WPF Desktop –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (C#, .NET Framework 4.6.1)

 **–ü–∞—Ç—Ç–µ—Ä–Ω** : MVVM (Model-View-ViewModel)

 **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ** : –°–±–æ—Ä, —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö —Å –ê–¶–ü –ø–æ –ø—Ä–æ—Ç–æ–∫–æ–ª—É Modbus TCP

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫

```
DipMod/
‚îú‚îÄ‚îÄ Command/          # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–º–∞–Ω–¥ –¥–ª—è MVVM
‚îú‚îÄ‚îÄ Model/            # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îú‚îÄ‚îÄ ViewModel/        # ViewModel –¥–ª—è —Å–≤—è–∑—ã–≤–∞–Ω–∏—è UI –∏ –ª–æ–≥–∏–∫–∏
‚îú‚îÄ‚îÄ View/             # –ü—É—Å—Ç–∞—è –ø–∞–ø–∫–∞ (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
‚îú‚îÄ‚îÄ Properties/       # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ —Ä–µ—Å—É—Ä—Å—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ MainWindow.xaml   # –ì–ª–∞–≤–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îî‚îÄ‚îÄ Connectio.xaml    # –û–∫–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (—Å–æ–∑–¥–∞–Ω–æ, –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
```

---

## –î–µ—Ç–∞–ª—å–Ω—ã–π —Ä–∞–∑–±–æ—Ä —Ñ–∞–π–ª–æ–≤

### üîß Command/RelayCommand.cs

 **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ** : –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞—Ç—Ç–µ—Ä–Ω–∞ Command –¥–ª—è MVVM

```csharp
internal class RelayCommand : ICommand
```

 **–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏** :

* –†–µ–∞–ª–∏–∑—É–µ—Ç `ICommand` –¥–ª—è —Å–≤—è–∑—ã–≤–∞–Ω–∏—è –º–µ—Ç–æ–¥–æ–≤ —Å –∫–Ω–æ–ø–∫–∞–º–∏ –≤ XAML
* –ü—Ä–∏–Ω–∏–º–∞–µ—Ç `Action<object>` –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∏ `Func<object, bool>` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
* –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `CommandManager.RequerySuggested` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–æ–º–∞–Ω–¥

 **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ** : –í—Å–µ –∫–Ω–æ–ø–∫–∏ –≤ UI (–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ, –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫) –∏—Å–ø–æ–ª—å–∑—É—é—Ç —ç—Ç–æ—Ç –∫–ª–∞—Å—Å

---

### üìä Model/AnalogPort.cs

 **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ** : –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–æ–≥–æ–≤–æ–≥–æ –ø–æ—Ä—Ç–∞

```csharp
internal class AnalogPort
{
    public ushort IDPort;      // ID –ø–æ—Ä—Ç–∞ (0-7)
    public float value;         // –ó–Ω–∞—á–µ–Ω–∏–µ –≤ –≤–æ–ª—å—Ç–∞—Ö (-10 –¥–æ +10V)
    public DateTime TimeFroze;  // –í—Ä–µ–º—è —Å–Ω—è—Ç–∏—è –ø–æ–∫–∞–∑–∞–Ω–∏—è
}
```

 **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏** :

* –•—Ä–∞–Ω–∏—Ç RAW –¥–∞–Ω–Ω—ã–µ —Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
* `value` —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ 16-–±–∏—Ç–Ω–æ–≥–æ —á–∏—Å–ª–∞ –≤ –≤–æ–ª—å—Ç—ã
* –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –ë–î –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è

---

### üìä Model/DigitalPort.cs

 **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ** : –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ü–∏—Ñ—Ä–æ–≤–æ–≥–æ –ø–æ—Ä—Ç–∞

```csharp
internal class DigitalPort
{
    public ushort IDPort;      // ID –ø–æ—Ä—Ç–∞ (0-1)
    public bool value;          // –õ–æ–≥–∏—á–µ—Å–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (–≤–∫–ª/–≤—ã–∫–ª)
    public DateTime TimeFroze;  // –í—Ä–µ–º—è —Å–Ω—è—Ç–∏—è –ø–æ–∫–∞–∑–∞–Ω–∏—è
}
```

 **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏** :

* –í—Å–µ–≥–æ 2 —Ü–∏—Ñ—Ä–æ–≤—ã—Ö –ø–æ—Ä—Ç–∞ –≤ —Å–∏—Å—Ç–µ–º–µ
* –•—Ä–∞–Ω–∏—Ç –±–∏–Ω–∞—Ä–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è (true/false)

---

### üîå Model/Modbus.cs

 **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ** : –†–∞–±–æ—Ç–∞ —Å Modbus TCP –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–º

 **–ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã** :

```csharp
readonly TcpClient client;              // TCP —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
readonly IModbusMaster master;          // Modbus –º–∞—Å—Ç–µ—Ä
public SQlite db;                       // –≠–∫–∑–µ–º–ø–ª—è—Ä –ë–î
ushort startAddress = 0;                // –ù–∞—á–∞–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤
ushort numRegistersAnalog = 8;          // 8 –∞–Ω–∞–ª–æ–≥–æ–≤—ã—Ö —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤
ushort numRegistersADigital = 2;        // 2 —Ü–∏—Ñ—Ä–æ–≤—ã—Ö —Ä–µ–≥–∏—Å—Ç—Ä–∞
readonly ushort channelConfig = 0x0008; // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–∞–Ω–∞–ª–æ–≤
```

 **–ú–µ—Ç–æ–¥—ã** :

1. **`Modbus(string IpAdress, int machine)`** - –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä
   * –°–æ–∑–¥–∞–µ—Ç TCP –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ –ø–æ—Ä—Ç 502
   * –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç Modbus –º–∞—Å—Ç–µ—Ä
   * –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –≤—Å–µ—Ö 8 –∞–Ω–∞–ª–æ–≥–æ–≤—ã—Ö –∫–∞–Ω–∞–ª–æ–≤ (–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç 0x0008 –≤ —Ä–µ–≥–∏—Å—Ç—Ä—ã 40001-40008)
   * –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ë–î
2. **`GetAnalog()`** - –ß—Ç–µ–Ω–∏–µ –∞–Ω–∞–ª–æ–≥–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
   * –ß–∏—Ç–∞–µ—Ç 8 holding registers (—Ñ—É–Ω–∫—Ü–∏—è 0x03)
   * –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ –ë–î —á–µ—Ä–µ–∑ `db.InsertAnalog()`
   * –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Ñ–æ–Ω–æ–≤–æ–º –ø–æ—Ç–æ–∫–µ –¥–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ —Å–±–æ—Ä–∞
3. **`GetAnalogOnline()`** - –ß—Ç–µ–Ω–∏–µ –±–µ–∑ –∑–∞–ø–∏—Å–∏ –≤ –ë–î
   * –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç RAW –∑–Ω–∞—á–µ–Ω–∏—è –≤ –≤–æ–ª—å—Ç—ã: `val = s / 65536 * 20 - 10`
   * –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `ObservableCollection` –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
   * –ò–º–µ–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –∏—Å–∫–ª—é—á–µ–Ω–∏–π —Å –∑–∞–∫—Ä—ã—Ç–∏–µ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
4. **`GetDigital()`** - –ß—Ç–µ–Ω–∏–µ —Ü–∏—Ñ—Ä–æ–≤—ã—Ö –≤—Ö–æ–¥–æ–≤
   * –ß–∏—Ç–∞–µ—Ç discrete inputs (—Ñ—É–Ω–∫—Ü–∏—è 0x02)
   * –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ –ë–î
5. **`Start()`** - –ó–∞–ø—É—Å–∫ —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
   * –í—ã–∑—ã–≤–∞–µ—Ç `GetAnalog()` –∏ `GetDigital()`
   * –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

 **–í–∞–∂–Ω—ã–µ –¥–µ—Ç–∞–ª–∏** :

* –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è `0x0008` –æ–∑–Ω–∞—á–∞–µ—Ç —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã –ê–¶–ü (–≤–µ—Ä–æ—è—Ç–Ω–æ, –¥–∏–∞–ø–∞–∑–æ–Ω ¬±10V)
* –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π Modbus TCP –ø–æ—Ä—Ç 502
* –ê–¥—Ä–µ—Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (slave ID) –±–µ—Ä–µ—Ç—Å—è –∏–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `machine`

---

### üíæ Model/SQLite.cs

 **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ** : –†–∞–±–æ—Ç–∞ —Å –ª–æ–∫–∞–ª—å–Ω–æ–π –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö SQLite

 **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ë–î** :

```sql
-- –¢–∞–±–ª–∏—Ü–∞ –∞–Ω–∞–ª–æ–≥–æ–≤—ã—Ö –ø–æ—Ä—Ç–æ–≤
CREATE TABLE AnalogPort (
    IDPort INTEGER,
    Value INTEGER NOT NULL,        -- RAW –∑–Ω–∞—á–µ–Ω–∏–µ (0-65535)
    TimeFroze DATETIME NOT NULL,
    PRIMARY KEY (IDPort, TimeFroze)
);

-- –¢–∞–±–ª–∏—Ü–∞ —Ü–∏—Ñ—Ä–æ–≤—ã—Ö –ø–æ—Ä—Ç–æ–≤
CREATE TABLE DigitalPort (
    IDPort INTEGER,
    Value INTEGER NOT NULL,        -- 0 –∏–ª–∏ 1
    TimeFroze DATETIME NOT NULL,
    PRIMARY KEY (IDPort, TimeFroze)
);
```

 **–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã** :

1. **–í—Å—Ç–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö** :

* `InsertAnalog(AnalogPort aport)` - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –∞–Ω–∞–ª–æ–≥–æ–≤–æ–≥–æ –ø–æ—Ä—Ç–∞
* `InsertDigital(DigitalPort dport)` - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏ —Ü–∏—Ñ—Ä–æ–≤–æ–≥–æ –ø–æ—Ä—Ç–∞
* –ò—Å–ø–æ–ª—å–∑—É—é—Ç `lock (_lockObject)` –¥–ª—è –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
* –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç —Ñ–ª–∞–≥ `_isWriting` –≤–æ –≤—Ä–µ–º—è –∑–∞–ø–∏—Å–∏

1. **–ß—Ç–µ–Ω–∏–µ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö** :

* `GetDataAnalog()` - –≤—Å–µ –∑–∞–ø–∏—Å–∏ –∞–Ω–∞–ª–æ–≥–æ–≤—ã—Ö –ø–æ—Ä—Ç–æ–≤
* `GetDataDigital()` - –≤—Å–µ –∑–∞–ø–∏—Å–∏ —Ü–∏—Ñ—Ä–æ–≤—ã—Ö –ø–æ—Ä—Ç–æ–≤
* –ü—Ä–µ–æ–±—Ä–∞–∑—É—é—Ç RAW –∑–Ω–∞—á–µ–Ω–∏—è –≤ –≤–æ–ª—å—Ç—ã –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏

1. **–ß—Ç–µ–Ω–∏–µ —Å —Ñ–∏–ª—å—Ç—Ä–æ–º –ø–æ –≤—Ä–µ–º–µ–Ω–∏** :

* `GetDataAnalog(DateTime dateStart, DateTime dateEnd)` - –¥–∞–Ω–Ω—ã–µ –∑–∞ –ø–µ—Ä–∏–æ–¥
* –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç SQL-–∏–Ω—ä–µ–∫—Ü–∏–π

1. **–ß—Ç–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π** :

* `GetDataAnalogLast()` - –ø–æ—Å–ª–µ–¥–Ω–∏–µ 8 –∑–∞–ø–∏—Å–µ–π (–ø–æ –æ–¥–Ω–æ–π –Ω–∞ –ø–æ—Ä—Ç)
* `GetDataDigitalLast()` - –ø–æ—Å–ª–µ–¥–Ω–∏–µ 2 –∑–∞–ø–∏—Å–∏
* `GetAnalogPortToIdPort(int IdPort)` - –ø–æ—Å–ª–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ—Ä—Ç–∞
* –ò—Å–ø–æ–ª—å–∑—É—é—Ç `ORDER BY TimeFroze DESC LIMIT N`

 **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏** :

* –§–æ—Ä–º—É–ª–∞ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è: `val = (raw / 65536) * 20 - 10` (–¥–∏–∞–ø–∞–∑–æ–Ω -10 –¥–æ +10V)
* –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–ª–∞–≥–∞ `_isWriting` –ø–µ—Ä–µ–¥ —á—Ç–µ–Ω–∏–µ–º (–∑–∞—â–∏—Ç–∞ –æ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤)
* –ö–æ–º–ø–æ–∑–∏—Ç–Ω—ã–π PRIMARY KEY (`IDPort`, `TimeFroze`) - –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é

 **–ü—Ä–æ–±–ª–µ–º—ã** :

* –í `GetDataDigital(DateTime dateStart, DateTime dateEnd)` –æ—à–∏–±–∫–∞: –∑–∞–ø—Ä–æ—Å –∏–¥–µ—Ç –∫ —Ç–∞–±–ª–∏—Ü–µ `AnalogPort` –≤–º–µ—Å—Ç–æ `DigitalPort`
* –ù–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–ª—É—á–∞—è, –∫–æ–≥–¥–∞ –ë–î –∑–∞–Ω—è—Ç–∞ –≤–æ –≤—Ä–µ–º—è —á—Ç–µ–Ω–∏—è

---

### ‚öôÔ∏è Model/Settings.cs

 **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ** : –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞ –ø–æ—Ä—Ç–æ–≤

 **–ö–ª–∞—Å—Å `PortSettings`** :

```csharp
public class PortSettings : INotifyPropertyChanged
{
    public int PortId { get; set; }                    // ID –ø–æ—Ä—Ç–∞ (1-8)
    public string SelectedParameter { get; set; }       // –¢–∏–ø –∏–∑–º–µ—Ä–µ–Ω–∏—è
    public List<string> AvailableParameters { get; set; } // –°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ç–∏–ø–æ–≤
  
    // –î–∏–∞–ø–∞–∑–æ–Ω –≤—Ö–æ–¥–Ω–æ–≥–æ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è
    private double _inputMin = -10;
    private double _inputMax = 10;
  
    // –î–∏–∞–ø–∞–∑–æ–Ω –≤—ã—Ö–æ–¥–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
    private double _outputMin = 0;
    private double _outputMax = 100;
  
    // –°–º–µ—â–µ–Ω–∏–µ
    private double _offset = 0;
}
```

 **–ö–ª—é—á–µ–≤–æ–π –º–µ—Ç–æ–¥** :

```csharp
public double ConverttoParam(double value)
{
    return (value - inputMin) / (inputMax - inputMin) * 
           (outputMax - outputMin) + outputMin + offset;
}
```

 **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞** :

–ü—Ä–∏–º–µ—Ä: –¥–∞—Ç—á–∏–∫ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –≤—ã–¥–∞–µ—Ç -10V –ø—Ä–∏ 0¬∞C –∏ +10V –ø—Ä–∏ 100¬∞C

```
–ù–∞—Å—Ç—Ä–æ–π–∫–∏:
- inputMin = -10    (–º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ)
- inputMax = 10     (–º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ)
- outputMin = 0     (0¬∞C)
- outputMax = 100   (100¬∞C)
- offset = 0        (–±–µ–∑ –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏)

–ü—Ä–∏ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–∏ 0V:
ConverttoParam(0) = (0 - (-10)) / (10 - (-10)) * (100 - 0) + 0 + 0
                  = 10 / 20 * 100
                  = 50¬∞C
```

 **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ** :

* –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ—Ä—Ç–∞ —Ç–∏–ø –¥–∞—Ç—á–∏–∫–∞ (—Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞, –≤–ª–∞–∂–Ω–æ—Å—Ç—å –∏ —Ç.–¥.)
* –ü—Ä–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –≥—Ä–∞—Ñ–∏–∫–∞ –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–µ–æ–±—Ä–∞–∑—É—é—Ç—Å—è –∏–∑ –≤–æ–ª—å—Ç –≤ —Ñ–∏–∑–∏—á–µ—Å–∫–∏–µ –≤–µ–ª–∏—á–∏–Ω—ã
* –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ JSON —Ñ–∞–π–ª `portSettings.json`

---

### üé® ViewModel/ViewModel.cs

 **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ** : –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, —Å–≤—è–∑—ã–≤–∞–µ—Ç UI –∏ –º–æ–¥–µ–ª–∏

 **–û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–ª—è** :

```csharp
Modbus md;                          // –≠–∫–∑–µ–º–ø–ª—è—Ä Modbus –∫–ª–∏–µ–Ω—Ç–∞
private bool Connect = false;       // –§–ª–∞–≥ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
private bool Online = false;        // –§–ª–∞–≥ —Ä–µ–∂–∏–º–∞ –æ–Ω–ª–∞–π–Ω-–≥—Ä–∞—Ñ–∏–∫–∞
ObservableCollection<AnalogPort> analogPorts;        // –î–∞–Ω–Ω—ã–µ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
ObservableCollection<PortSettings> PortSettings;     // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ 8 –ø–æ—Ä—Ç–æ–≤
SeriesCollection SeriesCollection;                   // –î–∞–Ω–Ω—ã–µ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏
SeriesCollection SeriesCollectionOnline;             // –î–∞–Ω–Ω—ã–µ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞ –æ–Ω–ª–∞–π–Ω
```

 **–ö–æ–º–∞–Ω–¥—ã (RelayCommand)** :

1. **`EstablishConnection`** - –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤—É
   ```csharp
   - –°–æ–∑–¥–∞–µ—Ç —ç–∫–∑–µ–º–ø–ª—è—Ä Modbus(ipadress, machine)
   - –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç Connect = true
   - –ó–∞–ø—É—Å–∫–∞–µ—Ç —Ñ–æ–Ω–æ–≤—ã–π –ø–æ—Ç–æ–∫ Listening()
   - –ê–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –≤–∫–ª–∞–¥–∫–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ (IsEnabled = true)
   ```
2. **`EstablishDisconnection`** - –û—Ç–∫–ª—é—á–µ–Ω–∏–µ
   ```csharp
   - –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç Connect = false
   - –í—ã–∑—ã–≤–∞–µ—Ç md.Disconnect()
   ```
3. **`GetAllAnalog`** - –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –∞–Ω–∞–ª–æ–≥–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
   ```csharp
   - –ß–∏—Ç–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ 8 –∑–∞–ø–∏—Å–µ–π –∏–∑ –ë–î
   - –û–±–Ω–æ–≤–ª—è–µ—Ç —Å–≤–æ–π—Å—Ç–≤–∞ Aport1-Aport8 –¥–ª—è UI
   - –û–∂–∏–¥–∞–µ—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–ø–∏—Å–∏ —á–µ—Ä–µ–∑ —Ü–∏–∫–ª while
   ```
4. **`GetAllDigital`** - –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö —Ü–∏—Ñ—Ä–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
   ```csharp
   - –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ GetAllAnalog –¥–ª—è 2 —Ü–∏—Ñ—Ä–æ–≤—ã—Ö –ø–æ—Ä—Ç–æ–≤
   ```
5. **`GetValueAnalog`** - –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ—Ä—Ç–∞
   ```csharp
   - –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä CommandParameter (0-7)
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç switch –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω—É–∂–Ω–æ–≥–æ Aport
   - –û–∂–∏–¥–∞–µ—Ç –æ–∫–æ–Ω—á–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏ –≤ –ë–î
   ```
6. **`GetDataValue`** - –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞ –∑–∞ –ø–µ—Ä–∏–æ–¥
   ```csharp
   - –í—ã–∑—ã–≤–∞–µ—Ç db.GetDataAnalog(starttime, stoptime)
   - –í—ã–∑—ã–≤–∞–µ—Ç UpdateSeriesCollection() –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞
   ```
7. **`GetDataValueAll`** - –ó–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö
   ```csharp
   - –ó–∞–≥—Ä—É–∂–∞–µ—Ç –≤—Å—é –∏—Å—Ç–æ—Ä–∏—é –∏–∑ –ë–î
   - –°—Ç—Ä–æ–∏—Ç –≥—Ä–∞—Ñ–∏–∫
   ```
8. **`GetDataValueOnline`** - –°—Ç–∞—Ä—Ç/—Å—Ç–æ–ø –æ–Ω–ª–∞–π–Ω –≥—Ä–∞—Ñ–∏–∫–∞
   ```csharp
   - –ü–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç —Ñ–ª–∞–≥ Online
   - –ó–∞–ø—É—Å–∫–∞–µ—Ç —Ñ–æ–Ω–æ–≤—É—é –∑–∞–¥–∞—á—É UpdateSeriesCollectionOnline()
   - –û—á–∏—â–∞–µ—Ç –≥—Ä–∞—Ñ–∏–∫ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
   ```
9. **`SaveCommand`** - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø–æ—Ä—Ç–æ–≤
   ```csharp
   - –°–µ—Ä–∏–∞–ª–∏–∑—É–µ—Ç PortSettings –≤ JSON
   - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ —Ñ–∞–π–ª portSettings.json
   ```

 **–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã** :

1. **`UpdateSeriesCollection()`** - –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏
   ```csharp
   –õ–æ–≥–∏–∫–∞:
   - –ì—Ä—É–ø–ø–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ –ø–æ—Ä—Ç–∞–º
   - –§–∏–ª—å—Ç—Ä—É–µ—Ç –ø–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É –ø–∞—Ä–∞–º–µ—Ç—Ä—É (SelectParamDB)
   - –ü—Ä–∏–º–µ–Ω—è–µ—Ç –∫–∞–ª–∏–±—Ä–æ–≤–∫—É —á–µ—Ä–µ–∑ port.ConverttoParam()
   - –°–æ–∑–¥–∞–µ—Ç LineSeries –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ—Ä—Ç–∞
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥–±–∏—Ä–∞–µ—Ç —à–∞–≥ –æ—Å–∏ X –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –≤—Ä–µ–º–µ–Ω–∏:
     * > 1 –¥–µ–Ω—å: —à–∞–≥ 6 —á–∞—Å–æ–≤
     * > 6 —á–∞—Å–æ–≤: —à–∞–≥ 1 —á–∞—Å
     * > 1 —á–∞—Å: —à–∞–≥ 15 –º–∏–Ω—É—Ç
     * > 30 –º–∏–Ω—É—Ç: —à–∞–≥ 10 –º–∏–Ω—É—Ç
     * > 10 –º–∏–Ω—É—Ç: —à–∞–≥ 4 –º–∏–Ω—É—Ç—ã
     * > 1 –º–∏–Ω—É—Ç–∞: —à–∞–≥ 30 —Å–µ–∫—É–Ω–¥
     * –∏–Ω–∞—á–µ: —à–∞–≥ 10 —Å–µ–∫—É–Ω–¥
   ```
2. **`UpdateSeriesCollectionOnline()`** - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–Ω–ª–∞–π–Ω –≥—Ä–∞—Ñ–∏–∫–∞
   ```csharp
   –õ–æ–≥–∏–∫–∞:
   - –ë–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª while (Online)
   - –ö–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É –≤—ã–∑—ã–≤–∞–µ—Ç md.GetAnalogOnline()
   - –î–æ–±–∞–≤–ª—è–µ—Ç —Ç–æ—á–∫–∏ –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ LineSeries
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç Dispatcher.Invoke –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è UI –∏–∑ –¥—Ä—É–≥–æ–≥–æ –ø–æ—Ç–æ–∫–∞
   ```
3. **`Listening()`** - –§–æ–Ω–æ–≤—ã–π —Å–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö
   ```csharp
   –õ–æ–≥–∏–∫–∞:
   - –ë–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª while (Connect)
   - –°–æ–∑–¥–∞–µ—Ç Task –¥–ª—è md.Start() (–∑–∞–ø–∏—Å—å –≤ –ë–î)
   - –ü–∞—É–∑–∞ 1 —Å–µ–∫—É–Ω–¥–∞ –º–µ–∂–¥—É –∏—Ç–µ—Ä–∞—Ü–∏—è–º–∏
   ```
4. **`LoadSettings()`** - –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫
   ```csharp
   - –ß–∏—Ç–∞–µ—Ç portSettings.json –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
   - –î–µ—Å–µ—Ä–∏–∞–ª–∏–∑—É–µ—Ç –≤ PortSettings
   ```

 **–°–≤–æ–π—Å—Ç–≤–∞ –¥–ª—è –±–∏–Ω–¥–∏–Ω–≥–∞** :

```csharp
// –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
string Ipadress           // IP –∞–¥—Ä–µ—Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
int Machine               // Slave ID (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1)

// –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≥—Ä–∞—Ñ–∏–∫–∞
DateTime Starttime        // –ù–∞—á–∞–ª–æ –ø–µ—Ä–∏–æ–¥–∞
DateTime Stoptime         // –ö–æ–Ω–µ—Ü –ø–µ—Ä–∏–æ–¥–∞
string SelectParamDB      // –í—ã–±—Ä–∞–Ω–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è

// –ó–Ω–∞—á–µ–Ω–∏—è –ø–æ—Ä—Ç–æ–≤
float Aport1-Aport8       // –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –∞–Ω–∞–ª–æ–≥–æ–≤—ã—Ö –ø–æ—Ä—Ç–æ–≤
bool Dport1-Dport2        // –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è —Ü–∏—Ñ—Ä–æ–≤—ã—Ö –ø–æ—Ä—Ç–æ–≤
DateTime LastTimeFroze    // –í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∏–∑–º–µ—Ä–µ–Ω–∏—è

// –°–æ—Å—Ç–æ—è–Ω–∏–µ UI
bool IsEnabled            // –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤–∫–ª–∞–¥–æ–∫ (–≤–∫–ª—é—á–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è)
```

 **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏** :

* –í—Å–µ —Å–≤–æ–π—Å—Ç–≤–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç `INotifyPropertyChanged` –¥–ª—è –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è UI
* –ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å: —Ñ–æ–Ω–æ–≤—ã–µ Task –¥–ª—è —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –æ–Ω–ª–∞–π–Ω-–≥—Ä–∞—Ñ–∏–∫–∞
* –ó–∞—â–∏—Ç–∞ –æ—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –∑–∞–ø–∏—Å–∏/—á—Ç–µ–Ω–∏—è –ë–î —á–µ—Ä–µ–∑ —Ü–∏–∫–ª –æ–∂–∏–¥–∞–Ω–∏—è `while (read)`
* –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å MessageBox –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
* –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `Application.Current.Dispatcher.Invoke` –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è UI –∏–∑ –¥—Ä—É–≥–æ–≥–æ –ø–æ—Ç–æ–∫–∞

---

### üñºÔ∏è MainWindow.xaml / MainWindow.xaml.cs

**MainWindow.xaml** - –†–∞–∑–º–µ—Ç–∫–∞ –≥–ª–∞–≤–Ω–æ–≥–æ –æ–∫–Ω–∞

 **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞** :

```
TabControl (5 –≤–∫–ª–∞–¥–æ–∫):
‚îú‚îÄ‚îÄ ConnectionParametr (–≤—Å–µ–≥–¥–∞ –∞–∫—Ç–∏–≤–Ω–∞)
‚îÇ   ‚îú‚îÄ‚îÄ TextBox: IP –∞–¥—Ä–µ—Å (–±–∏–Ω–¥–∏–Ω–≥ –Ω–∞ Ipadress)
‚îÇ   ‚îú‚îÄ‚îÄ TextBox: –ù–æ–º–µ—Ä —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (–±–∏–Ω–¥–∏–Ω–≥ –Ω–∞ Machine)
‚îÇ   ‚îú‚îÄ‚îÄ Button: –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è (EstablishConnection)
‚îÇ   ‚îî‚îÄ‚îÄ Button: –û—Ç–∫–ª—é—á–∏—Ç—å—Å—è (EstablishDisconnection, IsEnabled)
‚îÇ
‚îú‚îÄ‚îÄ Last Value (–∞–∫—Ç–∏–≤–Ω–∞ –ø–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è)
‚îÇ   ‚îú‚îÄ‚îÄ 8 —Å—Ç—Ä–æ–∫ —Å –∞–Ω–∞–ª–æ–≥–æ–≤—ã–º–∏ –ø–æ—Ä—Ç–∞–º–∏:
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ TextBlock: –ó–Ω–∞—á–µ–Ω–∏–µ (Aport1-8)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Button: Get (GetValueAnalog —Å CommandParameter)
‚îÇ   ‚îú‚îÄ‚îÄ 2 —Å—Ç—Ä–æ–∫–∏ —Å —Ü–∏—Ñ—Ä–æ–≤—ã–º–∏ –ø–æ—Ä—Ç–∞–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ Button: Get All Analog (GetAllAnalog)
‚îÇ   ‚îî‚îÄ‚îÄ Button: Get All Digital (GetAllDigital)
‚îÇ
‚îú‚îÄ‚îÄ Database (–∞–∫—Ç–∏–≤–Ω–∞ –ø–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è)
‚îÇ   ‚îú‚îÄ‚îÄ TextBox: StartTime (Starttime)
‚îÇ   ‚îú‚îÄ‚îÄ TextBox: EndTime (Stoptime)
‚îÇ   ‚îú‚îÄ‚îÄ CartesianChart: –ì—Ä–∞—Ñ–∏–∫ (SeriesCollection, AxesX)
‚îÇ   ‚îú‚îÄ‚îÄ ComboBox: –ü–∞—Ä–∞–º–µ—Ç—Ä (SelectParamDB)
‚îÇ   ‚îú‚îÄ‚îÄ Button: get (GetDataValue)
‚îÇ   ‚îî‚îÄ‚îÄ Button: get all (GetDataValueAll)
‚îÇ
‚îú‚îÄ‚îÄ Online (–∞–∫—Ç–∏–≤–Ω–∞ –ø–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è)
‚îÇ   ‚îú‚îÄ‚îÄ CartesianChart: –ì—Ä–∞—Ñ–∏–∫ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ (SeriesCollectionOnline)
‚îÇ   ‚îî‚îÄ‚îÄ Button: Start/Stop (GetDataValueOnline)
‚îÇ
‚îî‚îÄ‚îÄ Settings (–∞–∫—Ç–∏–≤–Ω–∞ –ø–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è)
    ‚îú‚îÄ‚îÄ 8 —Å—Ç—Ä–æ–∫ (–ø–æ –æ–¥–Ω–æ–π –Ω–∞ –ø–æ—Ä—Ç):
    ‚îÇ   ‚îú‚îÄ‚îÄ ComboBox: –¢–∏–ø –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ (PortSettings[i].SelectedParameter)
    ‚îÇ   ‚îú‚îÄ‚îÄ TextBox: Max voltage (PortSettings[i].inputMax)
    ‚îÇ   ‚îú‚îÄ‚îÄ TextBox: Min voltage (PortSettings[i].inputMin)
    ‚îÇ   ‚îú‚îÄ‚îÄ TextBox: Max index (PortSettings[i].outputMax)
    ‚îÇ   ‚îú‚îÄ‚îÄ TextBox: Min index (PortSettings[i].outputMin)
    ‚îÇ   ‚îî‚îÄ‚îÄ TextBox: Offset (PortSettings[i].offset)
    ‚îî‚îÄ‚îÄ Button: Save (SaveCommand)
```

**MainWindow.xaml.cs** - Code-behind

```csharp
public partial class MainWindow : Window
{
    public MainWindow()
    {
        ViewModelApp vm = new ViewModelApp();
        DataContext = vm;  // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ ViewModel –∫–∞–∫ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–∞–Ω–Ω—ã—Ö
        InitializeComponent();
    }
}
```

 **–í–∞–∂–Ω—ã–µ –¥–µ—Ç–∞–ª–∏** :

* –í—Å–µ –≤–∫–ª–∞–¥–∫–∏ –∫—Ä–æ–º–µ –ø–µ—Ä–≤–æ–π –∏–º–µ—é—Ç `IsEnabled="{Binding IsEnabled}"` - –∞–∫—Ç–∏–≤–∏—Ä—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
* `CommandParameter` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –Ω–æ–º–µ—Ä–∞ –ø–æ—Ä—Ç–∞ –≤ –∫–æ–º–∞–Ω–¥—ã
* `UpdateSourceTrigger=PropertyChanged` –¥–ª—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–∏ –≤–≤–æ–¥–µ
* `d:DataContext="{d:DesignInstance Type=viewmodel:ViewModelApp}"` –¥–ª—è IntelliSense –≤ XAML

---

### üìÑ Connectio.xaml / Connectio.xaml.cs

 **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ** : –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (—Å–æ–∑–¥–∞–Ω–æ, –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)

 **–°–æ–¥–µ—Ä–∂–∏–º–æ–µ** :

* –ü–æ–ª–µ –¥–ª—è –≤–≤–æ–¥–∞ IP
* –ö–Ω–æ–ø–∫–∞ "–ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è"
* –ë–∏–Ω–¥–∏–Ω–≥–∏ –Ω–∞ —Ç–µ –∂–µ —Å–≤–æ–π—Å—Ç–≤–∞ (Ipadress, EstablishConnection)

 **–°—Ç–∞—Ç—É—Å** : –ú–µ—Ä—Ç–≤—ã–π –∫–æ–¥, –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –Ω–∏–≥–¥–µ –≤ –ø—Ä–æ–µ–∫—Ç–µ. –í–∏–¥–∏–º–æ, –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–ª–æ—Å—å –æ—Ç–¥–µ–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è, –Ω–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –ø–µ—Ä–µ–Ω–µ—Å–ª–∏ –≤ –≥–ª–∞–≤–Ω–æ–µ –æ–∫–Ω–æ.

---

### üóÇÔ∏è –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã

 **App.xaml / App.xaml.cs** :

* –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ WPF –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
* `StartupUri="MainWindow.xaml"` - –∑–∞–ø—É—Å–∫ –≥–ª–∞–≤–Ω–æ–≥–æ –æ–∫–Ω–∞

 **packages.config** :
–°–ø–∏—Å–æ–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:

```xml
- LiveCharts 0.9.7           (–≥—Ä–∞—Ñ–∏–∫–∏)
- LiveCharts.Wpf 0.9.7       (WPF –æ–±–µ—Ä—Ç–∫–∞ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤)
- NModbus 3.0.81             (Modbus TCP –ø—Ä–æ—Ç–æ–∫–æ–ª)
- Microsoft.Data.Sqlite 8.0.10 (—Ä–∞–±–æ—Ç–∞ —Å SQLite)
- SQLitePCLRaw.bundle_e_sqlite3 (–Ω–∞—Ç–∏–≤–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ SQLite)
- System.Text.Json 9.0.4     (—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫)
```

 **DipMod.csproj** :

* –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
* –°—Å—ã–ª–∫–∏ –Ω–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
* –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–±–æ—Ä–∫–∏ (Debug/Release)
* .NET Framework 4.6.1

 **App.config** :

* Binding redirects –¥–ª—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –≤–µ—Ä—Å–∏–π –±–∏–±–ª–∏–æ—Ç–µ–∫
* –û—Å–æ–±–µ–Ω–Ω–æ –≤–∞–∂–Ω–æ –¥–ª—è System.Memory –∏ SQLite

 **.gitignore** :

* –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π .gitignore –¥–ª—è Visual Studio
* –ò—Å–∫–ª—é—á–∞–µ—Ç bin/, obj/, .vs/, packages/ –∏ —Ç.–¥.

---

## –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∏ —Ñ–∏—à–∫–∏

### 1. –ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å

 **–§–æ–Ω–æ–≤—ã–π —Å–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö** :

```csharp
void Listening()
{
    while (Connect) {
        Task Writing = new Task(() => { md.Start(); });
        Writing.Start();
        Task.Delay(1000).Wait();  // –ò–Ω—Ç–µ—Ä–≤–∞–ª —Å–±–æ—Ä–∞: 1 —Å–µ–∫—É–Ω–¥–∞
    }
}
```

 **–û–Ω–ª–∞–π–Ω –≥—Ä–∞—Ñ–∏–∫** :

```csharp
private async void UpdateSeriesCollectionOnline()
{
    while (Online)
    {
        analogPortsOnline = md.GetAnalogOnline();
        Application.Current.Dispatcher.Invoke(() => {
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI –∏–∑ –¥—Ä—É–≥–æ–≥–æ –ø–æ—Ç–æ–∫–∞
        });
        await Task.Delay(1000);
    }
}
```

### 2. –ü–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ë–î

```csharp
private bool _isWriting = false;
private readonly object _lockObject = new object();

public void InsertAnalog(AnalogPort aport)
{
    lock (_lockObject)  // –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä–∏ –∑–∞–ø–∏—Å–∏
    {
        _isWriting = true;
        // ... –∑–∞–ø–∏—Å—å –≤ –ë–î
        _isWriting = false;
    }
}

public ObservableCollection<AnalogPort> GetDataAnalog()
{
    if(_isWriting)  // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ —á—Ç–µ–Ω–∏–µ–º
    {
        return null;
    }
    // ... —á—Ç–µ–Ω–∏–µ –∏–∑ –ë–î
}
```

### 3. –£–º–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–¥–±–æ—Ä —à–∞–≥–∞ –æ—Å–∏ –≤—Ä–µ–º–µ–Ω–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –¥–∞–Ω–Ω—ã—Ö:

```csharp
var range = TimeSpan.FromTicks(maxTime - minTime);

if (range.TotalDays > 1)
    stepTicks = TimeSpan.FromHours(6).Ticks;
else if (range.TotalHours > 6)
    stepTicks = TimeSpan.FromHours(1).Ticks;
// ... –∏ —Ç.–¥.
```

### 4. –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –¥–∞—Ç—á–∏–∫–æ–≤

–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∞–∂–¥–æ–≥–æ –ø–æ—Ä—Ç–∞ –ø–æ–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –¥–∞—Ç—á–∏–∫:

* –¢–∏–ø –∏–∑–º–µ—Ä—è–µ–º–æ–π –≤–µ–ª–∏—á–∏–Ω—ã (—Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞, –≤–ª–∞–∂–Ω–æ—Å—Ç—å –∏ —Ç.–¥.)
* –î–∏–∞–ø–∞–∑–æ–Ω –≤—Ö–æ–¥–Ω–æ–≥–æ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è
* –î–∏–∞–ø–∞–∑–æ–Ω –≤—ã—Ö–æ–¥–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
* –°–º–µ—â–µ–Ω–∏–µ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏

### 5. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫

–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ—Ä—Ç–æ–≤ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ JSON –∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ:

```csharp
var json = JsonSerializer.Serialize(PortSettings);
File.WriteAllText("portSettings.json", json);
```

---

## –ü—Ä–æ–±–ª–µ–º—ã –∏ –Ω–µ–¥–æ—á–µ—Ç—ã

### üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ

1. **–û—à–∏–±–∫–∞ –≤ SQL –∑–∞–ø—Ä–æ—Å–µ** (`SQLite.cs:131`):

```csharp
// GetDataDigital –≤—ã–±–∏—Ä–∞–µ—Ç –∏–∑ AnalogPort –≤–º–µ—Å—Ç–æ DigitalPort
insertCommand.CommandText = $"select * from AnalogPort where ...";
```

2. **–ù–µ–±–µ–∑–æ–ø–∞—Å–Ω–∞—è –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è –≤ SQL** (`SQLite.cs:131`):

```csharp
$"... where TimeFroze>{dateStart} and TimeFroze<{dateEnd}"
// –ù–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü–∏–∏, –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç GetDataAnalog
```

3. **–ë–µ—Å–∫–æ–Ω–µ—á–Ω—ã–µ —Ü–∏–∫–ª—ã –æ–∂–∏–¥–∞–Ω–∏—è** :

```csharp
bool read = true;
while (read) {
    analogPorts = md.db.GetDataAnalogLast();
    if (analogPorts != null) read = false;
}
// –ù–µ—Ç —Ç–∞–π–º–∞—É—Ç–∞ –∏–ª–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–ø—ã—Ç–æ–∫
```

### üü° –°—Ä–µ–¥–Ω–∏–µ

4. **–ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –∫–æ–¥** :

* `Connectio.xaml` –∏ `Connectio.xaml.cs` –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è
* –ü–∞–ø–∫–∞ `View/` –ø—É—Å—Ç–∞—è

4. **–ñ–µ—Å—Ç–∫–æ –∑–∞–¥–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è** :

```csharp
private int znach = 10;  // –î–∏–∞–ø–∞–∑–æ–Ω –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è
readonly ushort channelConfig = 0x0008;  // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–∞–Ω–∞–ª–æ–≤
```

6. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏** :

* IP –∞–¥—Ä–µ—Å –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å
* –ù–æ–º–µ—Ä —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –ª—é–±—ã–º —á–∏—Å–ª–æ–º
* –î–∏–∞–ø–∞–∑–æ–Ω—ã –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏ –Ω–µ –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç—Å—è

6. **–ù–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞** :

* –ü—Ä–∏ –ø–æ—Ç–µ—Ä–µ —Å–≤—è–∑–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–æ—Å—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ—à–∏–±–∫—É
* –ù–µ –ø—ã—Ç–∞–µ—Ç—Å—è –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è
* –§–æ–Ω–æ–≤—ã–π –ø–æ—Ç–æ–∫ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å

### üü¢ –ú–µ–ª–∫–∏–µ

8. **–°–º–µ—à–∞–Ω–Ω—ã–π —Å—Ç–∏–ª—å –∫–æ–¥–∞** :

* –†—É—Å—Å–∫–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
* –ê–Ω–≥–ª–∏–π—Å–∫–∏–µ –∏–º–µ–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
* –û–ø–µ—á–∞—Ç–∫–∏ (`Connectio` –≤–º–µ—Å—Ç–æ `Connection`)

8. **–ù–µ—Ç –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è** :

* –¢–æ–ª—å–∫–æ MessageBox –¥–ª—è –æ—à–∏–±–æ–∫
* –ù–µ—Ç —Ñ–∞–π–ª–æ–≤–æ–≥–æ –ª–æ–≥–∞ –∏–ª–∏ —Ç—Ä–µ–π—Å–∏–Ω–≥–∞

8. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ç–µ—Å—Ç–æ–≤** :

* –ù–µ—Ç unit-—Ç–µ—Å—Ç–æ–≤
* –ù–µ—Ç integration-—Ç–µ—Å—Ç–æ–≤

---

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é

### –ö—Ä–∏—Ç–∏—á–Ω–æ

1. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å SQL –±–∞–≥** –≤ `GetDataDigital(DateTime, DateTime)`
2. **–î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü–∏—é** –≤–æ –≤—Å–µ—Ö SQL –∑–∞–ø—Ä–æ—Å–∞—Ö
3. **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ç–∞–π–º–∞—É—Ç—ã** –≤ —Ü–∏–∫–ª–∞—Ö –æ–∂–∏–¥–∞–Ω–∏—è:

```csharp
int attempts = 0;
while (read && attempts < 10) {
    // ...
    attempts++;
    await Task.Delay(100);
}
```

### –í–∞–∂–Ω–æ

4. **–î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö** :

```csharp
if (!IPAddress.TryParse(ipadress, out _))
    throw new ArgumentException("–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π IP –∞–¥—Ä–µ—Å");
```

5. **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å reconnect –ª–æ–≥–∏–∫—É** :

```csharp
catch (SocketException ex)
{
    // –ü–æ–ø—ã—Ç–∫–∞ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
    await Task.Delay(5000);
    TryReconnect();
}
```

6. **–£–¥–∞–ª–∏—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –∫–æ–¥** (Connectio.xaml)

### –ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ

7. **–î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª** –¥–ª—è –∫–æ–Ω—Å—Ç–∞–Ω—Ç:

```json
{
  "voltageRange": 10,
  "channelConfig": "0x0008",
  "modbusPort": 502,
  "scanInterval": 1000
}
```

8. **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** :

```csharp
Logger.Info($"Connected to {ipAddress}");
Logger.Error($"Failed to read data: {ex.Message}");
```

9. **–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å-–∏–Ω–¥–∏–∫–∞—Ü–∏—é** –ø—Ä–∏ –¥–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö
10. **–°–¥–µ–ª–∞—Ç—å UI –±–æ–ª–µ–µ –æ—Ç–∑—ã–≤—á–∏–≤—ã–º** :

* async/await –≤–º–µ—Å—Ç–æ Task.Start()
* CancellationToken –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–¥–∞—á
* Progress`<T>` –¥–ª—è –∏–Ω–¥–∏–∫–∞—Ü–∏–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞

---

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–∏—Å—Ç–µ–º–∞ (flow –¥–∏–∞–≥—Ä–∞–º–º–∞)

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø—É—Å–∫–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
   ‚Üì
2. MainWindow —Å–æ–∑–¥–∞–µ—Ç ViewModelApp
   ‚Üì
3. ViewModelApp –∑–∞–≥—Ä—É–∂–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–∑ portSettings.json
   ‚Üì
4. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç IP –∏ –Ω–∞–∂–∏–º–∞–µ—Ç "–ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è"
   ‚Üì
5. EstablishConnection —Å–æ–∑–¥–∞–µ—Ç Modbus(IP, machine)
   ‚Üì
6. Modbus –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –ø–æ TCP, –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –∫–∞–Ω–∞–ª—ã
   ‚Üì
7. Modbus –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç SQLite –ë–î (Port.db)
   ‚Üì
8. –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Ñ–æ–Ω–æ–≤—ã–π –ø–æ—Ç–æ–∫ Listening()
   |
   ‚îú‚îÄ> –ö–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É:
   |   ‚îú‚îÄ> –ß–∏—Ç–∞–µ—Ç 8 –∞–Ω–∞–ª–æ–≥–æ–≤—ã—Ö —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤ (Modbus —Ñ—É–Ω–∫—Ü–∏—è 0x03)
   |   ‚îú‚îÄ> –ß–∏—Ç–∞–µ—Ç 2 —Ü–∏—Ñ—Ä–æ–≤—ã—Ö –≤—Ö–æ–¥–∞ (Modbus —Ñ—É–Ω–∫—Ü–∏—è 0x02)
   |   ‚îî‚îÄ> –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤ SQLite
   |
9. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –¥–∞–Ω–Ω—ã–º–∏:
   ‚îú‚îÄ> –í–∫–ª–∞–¥–∫–∞ "Last Value":
   |   ‚îî‚îÄ> GetAllAnalog/Digital —á–∏—Ç–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ –ë–î
   |
   ‚îú‚îÄ> –í–∫–ª–∞–¥–∫–∞ "Database":
   |   ‚îú‚îÄ> –í—ã–±–∏—Ä–∞–µ—Ç –ø–µ—Ä–∏–æ–¥ –≤—Ä–µ–º–µ–Ω–∏
   |   ‚îú‚îÄ> –í—ã–±–∏—Ä–∞–µ—Ç —Ç–∏–ø –ø–∞—Ä–∞–º–µ—Ç—Ä–∞
   |   ‚îú‚îÄ> GetDataValue —á–∏—Ç–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∑–∞ –ø–µ—Ä–∏–æ–¥
   |   ‚îî‚îÄ> UpdateSeriesCollection —Å—Ç—Ä–æ–∏—Ç –≥—Ä–∞—Ñ–∏–∫
   |
   ‚îú‚îÄ> –í–∫–ª–∞–¥–∫–∞ "Online":
   |   ‚îú‚îÄ> GetDataValueOnline –∑–∞–ø—É—Å–∫–∞–µ—Ç UpdateSeriesCollectionOnline()
   |   ‚îî‚îÄ> –ö–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É –¥–æ–±–∞–≤–ª—è–µ—Ç —Ç–æ—á–∫–∏ –Ω–∞ –≥—Ä–∞—Ñ–∏–∫
   |
   ‚îî‚îÄ> –í–∫–ª–∞–¥–∫–∞ "Settings":
       ‚îú‚îÄ> –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç —Ç–∏–ø –¥–∞—Ç—á–∏–∫–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ—Ä—Ç–∞
       ‚îú‚îÄ> –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –¥–∏–∞–ø–∞–∑–æ–Ω—ã –∏ —Å–º–µ—â–µ–Ω–∏–µ
       ‚îî‚îÄ> SaveCommand —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ portSettings.json
```

---

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤—É

1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
2. –í–≤–µ—Å—Ç–∏ IP –∞–¥—Ä–µ—Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `192.168.1.100`)
3. –£–∫–∞–∑–∞—Ç—å –Ω–æ–º–µ—Ä —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ Modbus (Slave ID, –æ–±—ã—á–Ω–æ `1`)
4. –ù–∞–∂–∞—Ç—å "–ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è"
5. –î–æ–∂–¥–∞—Ç—å—Å—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –≤–∫–ª–∞–¥–æ–∫

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–∞—Ç—á–∏–∫–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã

1. –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "Settings"
2. –î–ª—è –Ω—É–∂–Ω–æ–≥–æ –ø–æ—Ä—Ç–∞ –≤—ã–±—Ä–∞—Ç—å "–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞" –≤ ComboBox
3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –¥–∏–∞–ø–∞–∑–æ–Ω—ã:
   * Max voltage: `10` (–º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ –¥–∞—Ç—á–∏–∫–∞)
   * Min voltage: `-10` (–º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ –¥–∞—Ç—á–∏–∫–∞)
   * Max index: `100` (–º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞, ¬∞C)
   * Min index: `0` (–º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞, ¬∞C)
   * Offset: `0` (–∫–æ—Ä—Ä–µ–∫—Ü–∏—è, –µ—Å–ª–∏ –Ω—É–∂–Ω–∞)
4. –ù–∞–∂–∞—Ç—å "Save"

### –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –¥–µ–Ω—å

1. –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "Database"
2. –í –ø–æ–ª–µ "StartTime" –≤–≤–µ—Å—Ç–∏ –¥–∞—Ç—É –∏ –≤—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ –ø–µ—Ä–∏–æ–¥–∞
3. –í –ø–æ–ª–µ "EndTime" –≤–≤–µ—Å—Ç–∏ —Ç–µ–∫—É—â—É—é –¥–∞—Ç—É/–≤—Ä–µ–º—è
4. –í ComboBox –≤—ã–±—Ä–∞—Ç—å "–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞"
5. –ù–∞–∂–∞—Ç—å "get"
6. –ì—Ä–∞—Ñ–∏–∫ –ø–æ–∫–∞–∂–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤—Å–µ—Ö –ø–æ—Ä—Ç–æ–≤ —Å —Ç–∏–ø–æ–º "–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞"

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

1. –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "Online"
2. –ù–∞–∂–∞—Ç—å "Start/Stop"
3. –ù–∞ –≥—Ä–∞—Ñ–∏–∫–µ –Ω–∞—á–Ω—É—Ç –ø–æ—è–≤–ª—è—Ç—å—Å—è —Ç–æ—á–∫–∏ –≤—Å–µ—Ö 8 –ø–æ—Ä—Ç–æ–≤
4. –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –Ω–∞–∂–∞—Ç–∏–µ "Start/Stop" –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

---

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏

* **–ü—Ä–æ—Ç–æ–∫–æ–ª** : Modbus TCP
* **–§—É–Ω–∫—Ü–∏–∏ Modbus** :
* 0x03 (Read Holding Registers) –¥–ª—è –∞–Ω–∞–ª–æ–≥–æ–≤—ã—Ö
* 0x02 (Read Discrete Inputs) –¥–ª—è —Ü–∏—Ñ—Ä–æ–≤—ã—Ö
* **–ü–æ—Ä—Ç TCP** : 502 (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π Modbus TCP)
* **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ä—Ç–æ–≤** : 8 –∞–Ω–∞–ª–æ–≥–æ–≤—ã—Ö + 2 —Ü–∏—Ñ—Ä–æ–≤—ã—Ö
* **–î–∏–∞–ø–∞–∑–æ–Ω –ê–¶–ü** : -10V –¥–æ +10V (20V —Ä–∞–∑–º–∞—Ö)
* **–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –ê–¶–ü** : 16 –±–∏—Ç (0-65535)
* **–ò–Ω—Ç–µ—Ä–≤–∞–ª –æ–ø—Ä–æ—Å–∞** : 1 —Å–µ–∫—É–Ω–¥–∞
* **–ë–î** : SQLite (–ª–æ–∫–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª Port.db)
* **–§–æ—Ä–º–∞—Ç –Ω–∞—Å—Ç—Ä–æ–µ–∫** : JSON (portSettings.json)

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è —Å–±–æ—Ä–∞ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö —Å –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω—ã—Ö –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤. –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∫–ª—é—á–µ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:

‚úÖ –†–∞–±–æ—Ç–∞ –ø–æ Modbus TCP

‚úÖ –ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω—ã–π —Å–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö

‚úÖ –•—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π –ë–î

‚úÖ –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –∏ –æ–Ω–ª–∞–π–Ω –≥—Ä–∞—Ñ–∏–∫–∏

‚úÖ –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –¥–∞—Ç—á–∏–∫–æ–≤

‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫

–û–¥–Ω–∞–∫–æ –µ—Å—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –±–∞–≥–∏ –∏ –Ω–µ–¥–æ—á–µ—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø–µ—Ä–µ–¥ production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º. –ö–æ–¥ –≤–ø–æ–ª–Ω–µ —Ä–∞–±–æ—á–∏–π –¥–ª—è –¥–∏–ø–ª–æ–º–∞, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏ –¥–ª—è –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ–π —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏.
